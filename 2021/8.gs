n%{'|'%{' '%}%}%:i
{1={,.2=\.3=\.4=\7=|||},,}%
{+}*p

i
{~\
2{:x;.{,x=},}:f~~$:d1;
3f~$:d7;
4f~$:d4;
7f~$:d8;
6f{d1&,1=},~$:d6;
5f{d1 d6-&,!},~$:d5;
6f{d8 d5-&,2=},~$:d0;
6f{d4 d7|&,5=},~$:d9;
5f{d9|,7=},~$:d2;
5f{d1&,2=},~$:d3;
;10,{"d"\+~}%:a;
{$a?}%{\10*+}*
}%
{+}*
