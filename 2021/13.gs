n.+%{n%}%~\
{','%{~}%}%\
{.,p}:q;
9.?:w:e;
{' '%2='='%~\'y'=:x\~:y\{[e\]$0=:e}{[w\]$0=:w}if;{[~{x{}{\}if}:f~[.y 2*\-]$0=f]}%.|q{}:q;}/

0:y;
{print}:,;
{0:x;{.[x y]?){'O'}{' '}if,x):x w>!}do n,y):y e>!}do;
